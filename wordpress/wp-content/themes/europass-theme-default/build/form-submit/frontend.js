!function(){function e(e=document){e.querySelectorAll('[data-form-submit="1"]').forEach((e=>{if(e.__fcBound)return;e.__fcBound=!0;const t=e.getAttribute("data-scope-class")||".form-scope",o=e.getAttribute("data-action")||"/",n=(e.getAttribute("data-method")||"POST").toUpperCase(),r=e.getAttribute("data-success-message")||"OK",s=e.getAttribute("data-error-message")||"Error",c=document.querySelector(t);c?function(e,t){if(!t||e.__fcValBound)return;e.__fcValBound=!0;const o=()=>function(e,t){const o=function(e){const t=Array.from(e.querySelectorAll('[data-form-input="1"][name]')).filter((e=>!e.disabled));if(!t.length)return!1;const o=t.some((e=>!0===e.required)),n=e=>!o||!0===e.required,r=new Map;for(const e of t)if(("checkbox"===e.type||"radio"===e.type)&&n(e)){const t=r.get(e.name)||{required:!1,anyChecked:!1,hasInputs:!1};t.required=t.required||!0,t.anyChecked=t.anyChecked||e.checked,t.hasInputs=!0,r.set(e.name,t)}for(const e of t){var s;if(!n(e))continue;if("checkbox"===e.type||"radio"===e.type)continue;const t=e.tagName.toLowerCase();var c;if("file"!==e.type){if("select"!==t){if(""===(null!==(s=e.value)&&void 0!==s?s:"").toString().trim())return!1}else if(""===(null!==(c=e.value)&&void 0!==c?c:"").trim())return!1}else if(!(e.files&&e.files.length>0))return!1}for(const[,e]of r)if(e.required&&e.hasInputs&&!e.anyChecked)return!1;const a=e.querySelector('.cc-input[type="checkbox"][required]');return!(a&&!a.checked)}(t);e.classList.toggle("active",o)}(e,t);o(),t.addEventListener("input",o),t.addEventListener("change",o)}(e,c):console.warn("[form-components] scope element not found:",t),e.addEventListener("click",(c=>{c.preventDefault();const a=document.querySelector(t);if(!a)return console.warn("[form-components] scope element not found:",t),void alert("Не знайдено контейнер форми: "+t);!async function({action:e,method:t,scopeEl:o,button:n,successMessage:r,errorMessage:s}){const c=n.textContent;n.disabled=!0,n.classList.add("is-loading");try{const s=function(e){const t=e.querySelectorAll('[data-form-input="1"][name]'),o=new FormData;return t.forEach((e=>{var t;e.disabled||("checkbox"===e.type||"radio"===e.type?e.checked&&o.append(e.name,e.value||"on"):o.append(e.name,null!==(t=e.value)&&void 0!==t?t:""))})),o}(o),a={method:t||"POST"};if("GET"===(t||"POST").toUpperCase()){const t=new URLSearchParams;for(const[e,o]of s.entries())t.append(e,o);const o=e.includes("?")?`${e}&${t}`:`${e}?${t}`;if(!(await fetch(o,{method:"GET",credentials:"same-origin"})).ok)throw new Error("Network error")}else if(a.body=s,a.credentials="same-origin",!(await fetch(e,a)).ok)throw new Error("Network error");n.classList.remove("is-loading"),n.classList.add("is-success"),r&&alert(r),n.textContent=c}catch(e){n.classList.remove("is-loading"),n.classList.add("is-error"),s&&alert(s),console.error("[form-components] submit failed:",e),n.textContent=c}finally{n.disabled=!1,setTimeout((()=>{n.classList.remove("is-success","is-error")}),1200)}}({action:o,method:n,scopeEl:a,button:e,successMessage:r,errorMessage:s})}))}))}document.addEventListener("DOMContentLoaded",(()=>e(document))),document.addEventListener("wp-block-render",(t=>e(t.target||document)))}();